<body>
<div id="main">
    <div class="container">
        <div class="col-lg-6 logo"></div>
        <div class="col-lg-6" style="margin-bottom: 25px">
            <div class="panel-body">

                <form id="form" action="control/main.php?req=login" method="POST">
                    <div>
                        <p id="avisos" class=""></p>
                    </div>
                    <input id="user" type="text" name="login" class="form-control" placeholder="Usuário"
                           autocomplete="off">
                    <br>
                    <input type="password" class="form-control" name="senha" placeholder="Senha" autocomplete="off">
                    <br>
                    <button type="submit" href="#" class="btn btn-primary "> Entrar</button>
                    <a href="index.php?pag=Cad.Candidato">Não Tenho Conta</a>
                </form>
            </div>
        </div>
        <div class="col-lg-12 text-center">
            <br/>
            <a href="#listaOficinas" class="coolButton"> Oficinas Disponíveis </a>
        </div>
    </div>
</div>
<div id="listaOficinas" class="lista">
    <div class="container-fluid">
        <div class="cabecalho printOnly text-center">
            <div class="row">
                <img class="img-responsive" src="img/ufrrj_logo.png"/>
            </div>
            <div class="row">
                <h2>Pró-Reitoria de Extensão</h2>
                <h2>Departamento de Arte e Cultura</h2>
            </div>
            <br/>
            <br/>
            <p>
                Segue abaixo a relação de oficinas ativas em <span id="hoje"></span>, ofertadas pelo centro de Arte e Cultura desta universidade, e suas respectivas informações.
            </p>
            <br/>
        </div>
        <h3 id="titulo-lista">OFICINAS DISPONÍVEIS</h3>
        <br/>
        <div id="t_oficinas"></div>
    </div>
</div>
<div id="MainFooter" class="text-center">
    <!--TODO: adicionar redes sociais no footer (colocado nomes em ordem alfabetica) -->
    <div class="row">
        <small>Projetado por <a href="http://filipeklinger.16mb.com/">Filipe Klinger</a>, Luciano Viana,  e Vinícius Martins</small>
        <br/>
        <!--TODO: mudar line-height direito de cópia-->
        <span>&copy;CAC CENTRO DE ARTE E CULTURA | TODOS OS DIREITOS RESERVADOS</span>
    </div>
</div>
<script>
    $(document).on("load", getMsgs());
    ajaxLoadGET('control/main.php?req=selectTurmaAtiva', listaMarota, '#t_oficinas');

    function listaMarota(resposta, corpo) {
        var objJson = JSON.parse(resposta);
        console.log(objJson);
        var aux;
        if (objJson.length > 0) {
            for (var i in objJson) {
                //aqui obtemos o numero real de vagas disponiveis
                objJson[i].vagas = parseInt(objJson[i].vagas) - parseInt(objJson[i].ocupadas);
                if(objJson[i].vagas < 10){
                    objJson[i].vagas = '&nbsp;&nbsp;'+objJson[i].vagas;
                }
                //console.log(avaliaData(objJson[i]));
                var aux = JSON.parse(avaliaData(objJson[i]));
                //console.log(aux);
                corpo.append(
                    '<div class="media">'+
                    '<div class="media-left text-center">'+
                    '<span class="media-object">'+
                    objJson[i].vagas
                    +'</span>'+
                    '<span>vagas</span></div>'+
                    '<div class="media-body">'+
                    '<h4 class="media-heading">' + objJson[i].oficina + ' - '+ objJson[i].inicio +'</h4><span>'+aux+'</span>'+
                    '<p>Professor: ' + objJson[i].professor + '</p>'+
                    '<p>Local: '+ objJson[i].predio + ',  ' + objJson[i].sala + '</p>'+
                    '</div>'+
                    '</div>'
                );
            }
        }
        else {
            corpo.append(
                '<h2> :( Nenhuma turma disponível</h2>'
            );
        }
    }

    function avaliaData(jsonObject){
        var dias = new Array();
        if(jsonObject.segunda === '1'){
            dias.push("Seg");
        }
        if(jsonObject.terca === '1'){
            dias.push("Ter");
        }
        if(jsonObject.quarta === '1'){
            dias.push("Qua");
        }
        if(jsonObject.quinta === '1'){
            dias.push("Qui");
        }
        if(jsonObject.sexta === '1'){
            dias.push("Sex");
        }
        return JSON.stringify(dias);
    }
    //function currDate(){
        const now = new Date();
        var periodo;
        if(now.getMonth() > 6){
            periodo = 2;
        }
        else{
            periodo = 1;
        }
        document.getElementById('hoje').innerHTML = now.getUTCFullYear()+'-'+periodo;
    //}
</script>
</body>